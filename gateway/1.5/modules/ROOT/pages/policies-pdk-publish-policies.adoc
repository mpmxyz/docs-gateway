= Uploading Custom Policies to Exchange
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:imagesdir: ../assets/images

During the custom policy development cycle, you can upload your policy to Exchange to create an Exchange asset to manage the policy's version and to distribute it to other users. For more information about Exchange, see xref:exchange::index.adoc[].

When uploading your policy to Exchange, you can choose to either:

* <<publish, Publish a Custom Policy>> +
Publish a policy if the policy version is still in development. This enables you to test and edit the policy version.
* <<release, Release a Custom Policy>> +
Release the policy to create a definitive version of the policy. After releasing the policy, you must create a new policy version to edit the policy.

Both published and released policies are `stable` state assets. For more information about `stable` state assets, see xref:exchange::lifecycle.adoc#stablet-state[Stable State Assets].

After you upload your policy to Exchange, xref:policies-pdk-apply-policies.adoc[apply your policy to a Flex Gateway].

== Before You Begin

* Ensure that the Connected App you used to authenticate to the xref:policies-pdk-prerequisites.adoc#cli[Anypoint Platform CLI] has the `Exchange Contributor` scope applied.
* xref:policies-pdk-compile-policies.adoc[Compile your Policy].

[[publish]]
== Publish a Custom Policy

To publish a custom policy, run the `publish` command from the policy's root folder:

[source,ssh]
----
make publish
----

After publishing the asset, a new asset appears in Exchange:

image:pdk-dev-asset.png["Policy appear in Exchange labeled DEV."]

The asset's group ID, asset ID, and asset version (GAV) appear, similar to the following:

* *groupID*: `<organizationId>`
* *assetID*: `my-custom-policy-dev` 
+
When publishing a policy, `-dev` appears appended to the *assetID*.
* *version*: `1.0.0-20230618115723` 
+
When publishing a policy, a timestamp appears appended to the *version*.

Rerunning the publish command creates a new version of the policy asset with an updated timestamp. Previously published policy versions are still available.


[[release]]
== Release a Custom Policy

To release a custom policy, run the `release` command from the policy's root folder:

[source,ssh]
----
make release
----

After releasing the asset in Exchange, `DEV` is removed from the policy's name and the asset's GAV appears similar to the following:

* *groupID*: `<organizationId>`
* *assetID*: `my-custom-policy`
* *version*: `1.0.0`

After releasing the asset, rerunning the `release` command results in a conflict error.

To begin working on the next version of your policy, update the version number in the `Cargo.toml` file.

For example, if the latest version is `1.0.0`, update the `Cargo.toml` file as follows to begin working on a minor release:

[source,toml]
----
name = "my-custom-policy"
version = "1.1.0"
----
